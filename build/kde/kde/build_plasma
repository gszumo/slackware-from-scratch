#!/bin/bash

build_plasma () {
#********************************************************
cd /source/kde/kde || exit 1

export UPGRADE_PACKAGES=always

if ! ./kde.SlackBuild plasma-extra:plasma-wayland-protocols; then
	touch /tmp/kde_build/$package.failed && exit 1
fi

if ! ./kde.SlackBuild frameworks:kwayland; then 
	touch /tmp/kde_build/kwayland.failed && exit 1
fi

for package in \
	kgamma5 \
	kdecoration \
	breeze \
	breeze-gtk \
	breeze-grub \
	breeze-plymouth \
	qqc2-breeze-style \
	kwayland-integration \
	kwayland-server \
	plasma-integration \
	kinfocenter \
	layer-shell-qt \
	libksysguard \
	kscreenlocker \
	kwin \
	kwrited \
	libkscreen \
	milou \
	oxygen \
	plasma-workspace \
	kde-cli-tools \
	systemsettings \
	plasma-desktop \
	kdeplasma-addons \
	plasma-workspace-wallpapers \
	plasma5-nm \
	powerdevil \
	bluedevil \
	khotkeys \
	kmenuedit \
	polkit-kde-agent-1 \
	kscreen \
	sddm-kcm \
	kde-gtk-config \
	ksshaskpass \
	plasma-sdk \
	plasma-pa \
	kactivitymanagerd \
	xdg-desktop-portal-kde \
	drkonqi \
	plasma-vault \
	plasma-browser-integration \
	kwallet-pam \
	plasma-disks \
	plasma-nm \
	plasma-nano \
	plasma-firewall \
	plasma-phone-components \
	plasma-systemmonitor \
	plasma-tests \
	plasma-thunderbolt \
	plasma-kcm \
	ksystemstats \
  ; do
   	if ! ./kde.SlackBuild plasma:$package; then
		touch /tmp/kde_build/$package.failed && exit 1
	fi
done

# Keep MIME database current:
/usr/bin/update-mime-database /usr/share/mime 1>/dev/null 2>/dev/null &

mv -v /tmp/kde_build/*.txz /slackware64/kde
cd /scripts || exit 1
}

build_plasma
