#!/bin/bash

build_kdepim () {
#********************************************************
cd /source/kde/kde || exit 1

export UPGRADE_PACKAGES=always

if ! ./kde.SlackBuild applications-extra:kdiagram; then
	touch /tmp/kde_build/kdiagram.failed
fi

for package in \
	akonadi \
	kpimtextedit \
	kidentitymanagement \
	kcalutils \
	libkgapi \
	kmime \
	ksmtp \
	kimap \
	kmbox \
	kldap \
	kontactinterface \
	ktnef \
	grantleetheme \
	akonadi-mime \
	libkleo \
	akonadi-contacts \
	akonadi-notes \
	akonadi-search \
	kalarmcal \
	kmailtransport \
	akonadi-calendar \
	libkdepim \
	pimcommon \
	libgravatar \
	libksieve \
	mailimporter \
	calendarsupport \
	eventviews \
	incidenceeditor \
	messagelib \
	mailcommon \
	kleopatra \
	kpkpass \
  	kopeninghours \
	kitinerary \
	kdepim-addons \
	kdepim-runtime \
	akonadi-calendar-tools \
	akonadiconsole \
	akonadi-import-wizard \
	akregator \
	grantlee-editor \
	kaddressbook \
	kalarm \
	kmail \
	kmail-account-wizard \
	knotes \
	kontact \
	korganizer \
	mbox-importer \
	pim-data-exporter \
	pim-sieve-editor \
  ; do
   	if ! ./kde.SlackBuild kdepim:$package; then
		touch /tmp/kde_build/$package.failed && exit 1
	fi
done

if ! ./kde.SlackBuild plasma-extra:plasma-wayland-protocols; then
	touch /tmp/kde_build/$package.failed && exit 1
fi

# Keep MIME database current:
/usr/bin/update-mime-database /usr/share/mime 1>/dev/null 2>/dev/null &

mv -v /tmp/kde_build/*.txz /slackware64/kde
cd /scripts || exit 1
}

build_kdepim 
